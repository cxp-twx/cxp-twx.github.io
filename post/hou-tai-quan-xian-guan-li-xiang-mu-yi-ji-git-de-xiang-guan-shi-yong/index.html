<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>后台权限管理项目以及Git的相关使用 | CheckChen</title>
<meta name="description" content="吾日三省吾身" />
<link rel="shortcut icon" href="https://cxp-twx.github.io/favicon.ico?v=1576205647397">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://cxp-twx.github.io/styles/main.css">

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://cxp-twx.github.io">
  <img class="avatar" src="https://cxp-twx.github.io/images/avatar.png?v=1576205647397" alt="">
  </a>
  <h1 class="site-title">
    CheckChen
  </h1>
  <p class="site-description">
    吾日三省吾身
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              后台权限管理项目以及Git的相关使用
            </h2>
            <div class="post-info">
              <span>
                2019-09-21
              </span>
              <span>
                18 min read
              </span>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <p><ul class="markdownIt-TOC">
<li><a href="#%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93">权限管理项目总结：</a>
<ul>
<li><a href="#git%E7%9A%84%E4%BD%BF%E7%94%A8">Git的使用</a>
<ul>
<li><a href="#1%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E4%BB%93%E5%BA%93">1.创建一个仓库</a></li>
<li><a href="#2%E6%8A%8A%E8%A6%81%E7%AE%A1%E7%90%86%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%BA%A4%E7%BB%99git%E7%AE%A1%E7%90%86-%E5%B9%B6%E5%9C%A8idea%E4%B8%AD%E7%9A%84%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE">2.把要管理的项目交给git管理、并在IDEA中的简单配置</a></li>
<li><a href="#21%E6%88%96%E8%80%85%E4%BD%BF%E7%94%A8%E5%B0%8F%E4%B9%8C%E9%BE%9Fpull-and-push">2.1（或者使用小乌龟pull and push）</a>
<ul>
<li><a href="#git%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%9A%84%E4%BD%BF%E7%94%A8">Git命令行的使用</a></li>
</ul>
</li>
<li><a href="#3%E5%88%9B%E5%BB%BAgitignore%E6%96%87%E4%BB%B6%E8%BF%9B%E8%A1%8C%E5%BF%BD%E7%95%A5%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E7%9A%84%E8%8C%83%E5%9B%B4">3.创建.gitignore文件进行忽略上传文件的范围</a></li>
</ul>
</li>
<li><a href="#%E9%A1%B9%E7%9B%AE%E5%87%BA%E9%94%99%E5%8F%8A%E5%9F%BA%E7%A1%80%E7%82%B9">项目出错及基础点：</a><br>
*
<ul>
<li><a href="#%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4">批量删除</a></li>
<li><a href="#%E6%B7%BB%E5%8A%A0%E8%A7%92%E8%89%B2%E7%9A%84%E8%A1%A8%E6%A0%BC%E4%B8%B2%E8%81%94%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE">添加角色的表格串联插入数据</a></li>
<li><a href="#%E7%BC%96%E8%BE%91%E7%9A%84%E6%97%B6%E5%80%99%E7%82%B9%E5%87%BB%E8%A1%8C%E9%BB%98%E8%AE%A4%E5%B1%95%E7%A4%BA%E8%A1%8C%E7%9A%84%E8%A1%A8%E6%A0%BC%E6%95%B0%E6%8D%AE%E9%BB%98%E8%AE%A4%E5%8B%BE%E9%80%89">编辑的时候点击行默认展示行的表格数据（默认勾选）</a>
<ul>
<li><a href="#%E5%90%8E%E7%AB%AF%E6%9F%A5%E6%95%B0%E6%8D%AE%E7%AE%80%E5%8D%95%E4%B8%BB%E8%A6%81%E8%BF%98%E6%98%AF%E5%89%8D%E7%AB%AF%E4%B8%9C%E8%A5%BF">后端查数据简单，主要还是前端东西</a></li>
</ul>
</li>
<li><a href="#%E8%A1%A8%E6%A0%BC%E5%88%86%E9%A1%B5">表格分页</a></li>
</ul>
</li>
<li><a href="#%E5%85%B6%E4%BB%96%E7%BB%84%E5%91%98%E6%80%BB%E7%BB%93%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9">其他组员总结相关知识点</a>
<ul>
<li><a href="#restfullayui%E5%88%86%E9%A1%B5%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82">RESTful+layui+分页(异步请求)</a>
<ul>
<li><a href="#layui%E4%B8%AD%E5%85%88%E5%A3%B0%E6%98%8E%E8%87%AA%E5%B7%B1%E8%A6%81%E7%94%A8%E5%88%B0%E7%9A%84%E7%BB%84%E4%BB%B6">layui中先声明自己要用到的组件:</a></li>
<li><a href="#%E7%84%B6%E5%90%8E%E5%8E%BB%E6%89%BE%E8%87%AA%E5%B7%B1%E8%A6%81%E7%94%A8%E7%9A%84%E7%BB%84%E4%BB%B6%E7%9A%84%E7%9B%B8%E5%85%B3%E7%94%A8%E6%B3%95%E6%AF%94%E5%A6%82%E8%A1%A8%E6%A0%BC"><strong>然后去找自己要用的组件的相关用法,比如表格</strong></a></li>
</ul>
</li>
<li><a href="#restful%E6%8E%A7%E5%88%B6%E5%B1%82">RESTful控制层:</a></li>
<li><a href="#%E9%80%BB%E8%BE%91%E5%B1%82service">逻辑层Service</a></li>
<li><a href="#%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%8F%9C%E5%8D%95%E9%80%92%E5%BD%92">树形动态菜单(递归)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</p>
<h1 id="权限管理项目总结">权限管理项目总结：</h1>
<p><mark>项目图目录结构</mark>：</p>
<figure data-type="image" tabindex="1"><img src="https://img-blog.csdnimg.cn/20191102150759611.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NoZW5fbmVhbF9KYXZh,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></figure>
<h2 id="git的使用">Git的使用</h2>
<h3 id="1创建一个仓库">1.创建一个仓库</h3>
<p>空的仓库，不用选择模板，这样的话push工程的时候，问题不大。</p>
<h3 id="2把要管理的项目交给git管理-并在idea中的简单配置">2.把要管理的项目交给git管理、并在IDEA中的简单配置</h3>
<p><strong>第一步：添加一个git管理</strong></p>
<figure data-type="image" tabindex="2"><img src="https://img-blog.csdnimg.cn/20191102154955293.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NoZW5fbmVhbF9KYXZh,size_16,color_FFFFFF,t_70" alt="第一步"></figure>
<p><strong>第二步：</strong></p>
<figure data-type="image" tabindex="3"><img src="https://img-blog.csdnimg.cn/20191102155029686.png" alt="第二步"></figure>
<p><strong>第三步：右击项目添加自己创建的仓库的http下载和克隆地址</strong></p>
<figure data-type="image" tabindex="4"><img src="https://img-blog.csdnimg.cn/20191102155050634.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NoZW5fbmVhbF9KYXZh,size_16,color_FFFFFF,t_70" alt="第三步"></figure>
<p><strong>第四步：添加完成！</strong></p>
<figure data-type="image" tabindex="5"><img src="https://img-blog.csdnimg.cn/20191102155115763.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NoZW5fbmVhbF9KYXZh,size_16,color_FFFFFF,t_70" alt="第四步"></figure>
<p><strong>第五步：进行pull and push（commit） 进行修改后的项目，特别是多人协作的项目，要先进行下图箭头的操作进行更新代码，然后在进行对勾的操作。</strong></p>
<figure data-type="image" tabindex="6"><img src="https://img-blog.csdnimg.cn/2019110215513235.png" alt="第五步"></figure>
<p>六：注意事项</p>
<p><mark>多人合作的项目commit and push的时候有冲突的时候，进行代码合并，这时候不能选择accept yours、或accept their。选择Merge进行代码的手动整合。</mark></p>
<h3 id="21或者使用小乌龟pull-and-push">2.1（或者使用小乌龟pull and push）</h3>
<p><strong>1.在此之前要将此文件内容使用git.exe初始化</strong>：</p>
<figure data-type="image" tabindex="7"><img src="https://img-blog.csdnimg.cn/20191102162113846.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NoZW5fbmVhbF9KYXZh,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></figure>
<h4 id="git命令行的使用">Git命令行的使用</h4>
<ul>
<li>git init: 初始化git本地仓库</li>
<li>git status: 查看当前分支状态</li>
<li>git add: 将修改添加到工作区（暂存区）</li>
<li>git commit: 将修改提交到本地仓库</li>
<li>git log: 查看历次提交记录</li>
<li>git remote: 操作远程仓库</li>
</ul>
<p><strong>2.找到项目的本地文件夹，在空白处右击鼠标（同样是为了添加一个git的http下载地址）</strong></p>
<figure data-type="image" tabindex="8"><img src="https://img-blog.csdnimg.cn/2019110216094846.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NoZW5fbmVhbF9KYXZh,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></figure>
<figure data-type="image" tabindex="9"><img src="https://img-blog.csdnimg.cn/20191102162148281.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NoZW5fbmVhbF9KYXZh,size_16,color_FFFFFF,t_70" alt="添加地址"></figure>
<p><strong>3.成功之后再点击鼠标右键 ，进行先（如果是第一次上传可忽略）pull再push的操作完成git的远程仓库管理</strong></p>
<figure data-type="image" tabindex="10"><img src="https://img-blog.csdnimg.cn/20191102162651151.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NoZW5fbmVhbF9KYXZh,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></figure>
<h3 id="3创建gitignore文件进行忽略上传文件的范围">3.创建.gitignore文件进行忽略上传文件的范围</h3>
<h2 id="项目出错及基础点">项目出错及基础点：</h2>
<p><strong>首先逆向工程generatorConfig.xml文件中（生成多表格文件）添加代码:</strong></p>
<ul>
<li>
<property name="nullCatalogMeansCurrent" value="true"/>
</li>
</ul>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE generatorConfiguration
        PUBLIC &quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;&gt;

&lt;generatorConfiguration&gt;
    
	&lt;!-- 引入第三方依赖包 --&gt;
	
	&lt;classPathEntry location=&quot;.\lib\mysql-connector-java-8.0.12.jar&quot; /&gt;
	
	
	&lt;!--
     targetRuntime常用值:
        MyBatis3Simple(只生成基本的CRUD和少量的动态SQL)
        MyBatis3(生成完整的CRUD，包含CriteriaAPI方法Example后缀的方法)
     --&gt;
    &lt;context id=&quot;localhost_mysql&quot; targetRuntime=&quot;MyBatis3&quot;&gt;

        &lt;!-- 不生成注释 --&gt;
        &lt;commentGenerator&gt;
            &lt;property name=&quot;suppressAllComments&quot; value=&quot;true&quot; /&gt;
        &lt;/commentGenerator&gt;
		&lt;!--修改处01 --&gt;
        &lt;jdbcConnection driverClass=&quot;com.mysql.jdbc.Driver&quot;
                        connectionURL=&quot;jdbc:mysql://localhost:3306/right_management?characterEncoding=utf8&amp;amp;serverTimezone=UTC&quot;
                        userId=&quot;root&quot;
                        password=&quot;cxp123456.&quot;&gt;
						&lt;!--全限定或者是在table标签里添加catalog属性进一步进行限定指定的精确地方不要放错了位置 --&gt;
						&lt;property name=&quot;nullCatalogMeansCurrent&quot; value=&quot;true&quot;/&gt;
        &lt;/jdbcConnection&gt;

        &lt;javaTypeResolver &gt;
            &lt;property name=&quot;forceBigDecimals&quot; value=&quot;false&quot; /&gt;
        &lt;/javaTypeResolver&gt;

		&lt;!-- 生成实体类 --&gt;
		&lt;!--修改处02 --&gt;
        &lt;javaModelGenerator targetPackage=&quot;com.lanou.bean&quot; targetProject=&quot;src/main/java&quot;&gt;
            &lt;property name=&quot;enableSubPackages&quot; value=&quot;false&quot; /&gt;
            &lt;property name=&quot;trimStrings&quot; value=&quot;true&quot; /&gt;
			
			
        &lt;/javaModelGenerator&gt;

		&lt;!-- 生成XML Mapper --&gt;
		
		&lt;!-- 修改处03 --&gt;
        &lt;sqlMapGenerator targetPackage=&quot;src/main/resources/mappers&quot; targetProject=&quot;.&quot;&gt;
            &lt;property name=&quot;enableSubPackages&quot; value=&quot;false&quot; /&gt;
        &lt;/sqlMapGenerator&gt;

		&lt;!-- 生成Mapper接口 --&gt;
        &lt;!-- 生成的Mapper类型：ANNOTATEDMAPPER（注解）、MIXEDMAPPER（混合）、XMLMAPPER（XML） --&gt;
		
		&lt;!-- 修改处04 --&gt;
        &lt;javaClientGenerator type=&quot;XMLMAPPER&quot; targetPackage=&quot;com.lanou.mapper&quot;  targetProject=&quot;src/main/java&quot;&gt;
            &lt;!-- 是否将数据库中的schema作为包名的一部分，默认就是false --&gt;
            &lt;property name=&quot;enableSubPackages&quot; value=&quot;false&quot; /&gt;
        &lt;/javaClientGenerator&gt;
        &lt;!-- 选择性修改处05 --&gt;
		&lt;table tableName=&quot;privilege&quot;&gt;
		&lt;!--
        &lt;table schema=&quot;lanou&quot; tableName=&quot;message&quot; domainObjectName=&quot;TbContent&quot;&gt;
		--&gt;
            &lt;!-- 是否用数据库中的字段名作为POJO属性名(不自动转小驼峰)，默认值是false --&gt;
            &lt;!--
            &lt;property name=&quot;useActualColumnNames&quot; value=&quot;true&quot;/&gt;
            --&gt;
            &lt;!-- 生成代码时支持获取插入数据后自增的ID， 需要通过sqlStatement配置数据库类型。 --&gt;
			
			&lt;generatedKey column=&quot;id&quot; sqlStatement=&quot;mysql&quot; identity=&quot;true&quot; /&gt; 
			
            &lt;!-- 此标签用于在生成代码时忽略数据库中的某个字段 --&gt;
            &lt;!--
            &lt;ignoreColumn column=&quot;FRED&quot; /&gt;
            --&gt;
            &lt;!-- 通过此标签重写mybatis从数据库读到的元信息，自定义列相关配置，包括(名称、类型) --&gt;
            &lt;!--
            &lt;columnOverride column=&quot;aa&quot; property=&quot;sname&quot; /&gt;
            --&gt;
        &lt;/table&gt;
		
        &lt;table tableName=&quot;role&quot;&gt;
		  &lt;generatedKey column=&quot;id&quot; sqlStatement=&quot;mysql&quot; identity=&quot;true&quot; /&gt; 
		&lt;/table&gt;
		&lt;table tableName=&quot;role_privilege&quot;&gt;
		  
		&lt;/table&gt;
		&lt;table tableName=&quot;user&quot;&gt;
		  &lt;generatedKey column=&quot;id&quot; sqlStatement=&quot;mysql&quot; identity=&quot;true&quot; /&gt; 
		&lt;/table&gt;
		&lt;table tableName=&quot;user_role&quot;&gt;
		  
		&lt;/table&gt;
	
            
    &lt;/context&gt;
&lt;/generatorConfiguration&gt;
</code></pre>
<p><mark>拦截器的拦截路径设置对应的不是目录路径而是Controller层的访问路径</mark></p>
<ul>
<li>
<h4 id="批量删除">批量删除</h4>
</li>
</ul>
<pre><code class="language-javascript"> 
//Layui组件
&lt;script type=&quot;text/html&quot; id=&quot;toolbarDemo&quot;&gt;
 &lt;div class=&quot;layui-card-header&quot;&gt;
&lt;button class=&quot;layui-btn layui-btn-danger&quot;lay-event=&quot;getCheckData&quot;&gt;&lt;i class=&quot;layui-icon&quot;&gt;&lt;/i&gt;批量删除&lt;/button&gt;
&lt;/div&gt;
  &lt;/script&gt;




//监听头工具栏事件
        table.on('toolbar(demo)', function(obj){
            var checkStatus = table.checkStatus(obj.config.id);
            switch(obj.event){
                case 'getCheckData':
                    //传到后台的ID组合
                    var data = checkStatus.data;
                    var id = &quot;&quot;;
                    for (var ids in data){
                        console.log(data[ids]);
                        id += data[ids].rId;
                        id += &quot;,&quot;;
                    }
                    console.log(id)
                        console.log(data);
                    layer.confirm('真的删除多行吗？考虑下吧，大哥', function(index){
                            // console.log(data.rId);
                            $.ajax(&quot;/role/delAll&quot;,{
                                type:&quot;POST&quot;,
                                data:{
                                    // oper:&quot;msgDel&quot;,
                                    rid:id
                                },
                                dataType:&quot;json&quot;,
                                success:function(data,textStatus,jqXhr){
                                    if (data.code == 0){
                                        layer.msg(&quot;删除成功&quot;);
                                        /*刷新表格layui*/
                                        tableIns.reload();
                                        layer.close(index);
                                    }else{
                                        layer.msg(&quot;删除失败&quot;);
                                    }
                                }
                            });


                        });
                    /*layer.alert(JSON.stringify(data));*/
                    /*getSelectIds(data);*/
                    /*break;*/
            };
        });
</code></pre>
<ul>
<li>
<h4 id="添加角色的表格串联插入数据">添加角色的表格串联插入数据</h4>
</li>
</ul>
<p><strong>Controller层</strong></p>
<pre><code class="language-java"> //添加角色信息:搞定、刺激啊
    @RequestMapping(&quot;/add&quot;)
    @ResponseBody
    public Map&lt;Object,Object&gt; roleAdd(@RequestParam(value = &quot;name&quot;,required = false) String name,
                       @RequestParam(value = &quot;role1&quot;, required = false) String role1,
                       @RequestParam(value = &quot;role2&quot;, required = false) String role2,
                       @RequestParam(value = &quot;desc&quot;,required = false) String desc){

        Map&lt;Object,Object&gt; map = new HashMap&lt;&gt;();

        /*
         * 添加角色到两个表（role和权限表）,返回index
         *
         */
        int index = roleService.addRole(name,desc);
        //添加了权限列表值和R_P表搞定两个表
        privilegeService.addPrivilegePidAndRid(name,role1);
        privilegeService.addPrivilegePidAndRid(name,role2);
        if (index &gt; 0){
            System.out.println(&quot;添加成功&quot;);
            map.put(&quot;code&quot;, 0);
        }else{
            System.out.println(&quot;添加角色信息失败&quot;);
            map.put(&quot;code&quot;, 1);
        }

        map.put(&quot;msg&quot;,&quot;&quot;);
        map.put(&quot;count&quot;,&quot;&quot;);
        map.put(&quot;data&quot;,&quot;&quot;);

        return map;
    }
</code></pre>
<p><strong>service层</strong></p>
<pre><code class="language-java">//串联插入（不全）
@Override
    //添加角色至于她拥有什么权利看privilege表
    public int addRole(String name,String desc) {

        record.setrName(name);
        record.setrRemark(desc);
        return roleMapper.insertSelective(record);
    }



/*******************_________________________***********************/

//查询rid并插入R_P表
    @Override
    public int addPrivilegePidAndRid(String name,String role1) {
        Role role = addPrivilege(name, role1);
        Integer rId = role.getrId();


        RolePrivilegeKey rpk = new RolePrivilegeKey();
        //为了得到pid
        PrivilegeExample pe = new PrivilegeExample();

        pe.createCriteria().andPNameLike(role1);

        List&lt;Privilege&gt; ids = privilegeMapper.selectByExample(pe);
        for (Privilege p :ids){
            Integer pId = p.getpId();
            rpk.setpId(pId);
        }
        rpk.setrId(rId);
        return rpm.insert(rpk);
    }
</code></pre>
<ul>
<li>
<h4 id="编辑的时候点击行默认展示行的表格数据默认勾选">编辑的时候点击行默认展示行的表格数据（默认勾选）</h4>
<ul>
<li>
<h5 id="后端查数据简单主要还是前端东西">后端查数据简单，主要还是前端东西</h5>
</li>
</ul>
</li>
</ul>
<pre><code class="language-js">&lt;script&gt;
    //从本地存储的数据中取值
    var rid = localStorage.getItem(&quot;rid&quot;);
    var rname = localStorage.getItem(&quot;rname&quot;);
    var remark = localStorage.getItem(&quot;remark&quot;);
    // console.log(rid);
    //附件赋值
    $(&quot;#rid&quot;).attr(&quot;value&quot;,rid);
    $(&quot;#rname&quot;).attr(&quot;value&quot;,rname);
    $(&quot;#desc&quot;).text(remark);

    layui.use(['form','layer'], function(){

        $ = layui.jquery;
        var form = layui.form
            ,layer = layui.layer;

        //异步加载权限树
        var url = &quot;/role/get_ps/&quot;+rid;
        $.getJSON(url, function(data){
            console.log(data);
            if(!data || data.code != 200) {
                layer.alert(&quot;获取权限树数据出错!&quot;);
                return;
            }
            var permissionTree = data.data;

            buildPermissionTree(permissionTree);

            form.render();
        });


        //构建权限树
        function buildPermissionTree(permissionTree) {
            for(var idx in permissionTree) {
                var permission = permissionTree[idx];
                var children = permission.children; // 子菜单
                var id = permission.pId; // 菜单ID
                var privilege = permission.pName;   // 菜单名称
                var url = &quot;javascript:;&quot;;
                var check = permission.check;

                if(!children) {

                    // &lt;tr&gt;
                    //     &lt;td&gt;
                    //         &lt;input type=&quot;checkbox&quot; name=&quot;role1&quot; lay-skin=&quot;primary&quot; lay-filter=&quot;father&quot; title=&quot;用户管理&quot;&gt;
                    //     &lt;/td&gt;
                    //     &lt;td&gt;
                    //         &lt;div class=&quot;layui-input-block&quot;&gt;
                    //         &lt;/div&gt;
                    //      &lt;/td&gt;
                    // &lt;/tr&gt;
                    var tr = $(&quot;&lt;tr&gt;&lt;/tr&gt;&quot;);
                    var td1  = $(&quot;&lt;td&gt;&lt;/td&gt;&quot;);
                    var input = $(&quot;&lt;input type=\&quot;checkbox\&quot; lay-skin=\&quot;primary\&quot; lay-filter=\&quot;father\&quot; title=\&quot;&quot;+privilege+&quot;\&quot;&gt;&lt;/input&gt;&quot;);
                    var td2  = $(&quot;&lt;td&gt;&lt;/td&gt;&quot;);
                    var div = $(&quot;&lt;div class=\&quot;layui-input-block\&quot;&gt;&lt;/div&gt;&quot;);

                    // input.attr(&quot;title&quot;,privilege);

                    if (check = 1){//选中
                        input.attr(&quot;checked&quot;,&quot;true&quot;);
                    }
                    td1.append(input);
                    td2.append(div);
                    tr.append(td1);
                    tr.append(td2);

                    $(&quot;tbody[lay-filter='left_nav']&quot;).append(tr);

                } else {

                    //&lt;input name=&quot;role1&quot; lay-skin=&quot;primary&quot; type=&quot;checkbox&quot; title=&quot;用户停用&quot;value=&quot;用户停用&quot;&gt;

                    var tr = $(&quot;&lt;tr&gt;&lt;/tr&gt;&quot;);
                    var td1  = $(&quot;&lt;td&gt;&lt;/td&gt;&quot;);
                    var input = $(&quot;&lt;input name=\&quot;role1\&quot; type=\&quot;checkbox\&quot; lay-skin=\&quot;primary\&quot; lay-filter=\&quot;father\&quot; title=\&quot;&quot;+privilege+&quot;\&quot; value=\&quot;&quot;+privilege+&quot;\&quot;&gt;&quot;);
                    var td2  = $(&quot;&lt;td&gt;&lt;/td&gt;&quot;);
                    var div = $(&quot;&lt;div class=\&quot;layui-input-block\&quot;&gt;&lt;/div&gt;&quot;);

                    if (check = 1){//选中
                        input.attr(&quot;checked&quot;,&quot;true&quot;);
                    }

                    for(var idx1 in children) {
                        var child_permission = children[idx1];
                        var id = child_permission.pId; // 菜单ID
                        var privilege = child_permission.pName;   // 菜单名称
                        var url = url;
                        var check = permission.check;
                        console.log(privilege);
                        var input = $(&quot;&lt;input name=\&quot;role2\&quot; type=\&quot;checkbox\&quot; lay-skin=\&quot;primary\&quot; lay-filter=\&quot;father\&quot; title=\&quot;&quot;+privilege+&quot;\&quot;&gt;&lt;/input&gt;&quot;);

                        if (check = 1){//选中
                            input.attr(&quot;checked&quot;,&quot;true&quot;);
                        }

                        div.append(input);
                    }

                    td1.append(input);
                    td2.append(div);
                    tr.append(td1);
                    tr.append(td2);

                    // $(&quot;tbody[lay-filter='left_nav']&quot;).append(tr);
                    $(&quot;#nav&quot;).append(tr);
                }
            }
        }
        
        
        ////////////////////////////////////////////////////////////////
        
       //触发编辑事件
         else if(obj.event === 'edit'){//编辑

                // localStorage.setItem(&quot;reply&quot;,JSON.stringify(obj.data));
                // $(&quot;#content&quot;).load(&quot;/welcome/sendPage.html&quot;);
                // var rid = data.rid;
                // console.log(data.rId);
                localStorage.setItem(&quot;rid&quot;,data.rId);
                localStorage.setItem(&quot;rname&quot;,data.rName);
                localStorage.setItem(&quot;remark&quot;,data.rRemark);
                xadmin.open('编辑','/admin/role_edit',600,400);
</code></pre>
<ul>
<li>
<h3 id="表格分页">表格分页</h3>
</li>
</ul>
<pre><code class="language-java">//layui 需要的json格式
@Override
    public LayUtils&lt;Role&gt; queryRolesForLayUI(Role condition, Integer pageSize, Integer currentPage) {

        List&lt;Role&gt; roles = queryAllRole(null);

        int startIdx = (currentPage - 1) * pageSize;
        int endIdx = currentPage * pageSize;
        if(endIdx &gt; roles.size()) {
            endIdx = roles.size();
        }
        //获取当前要展示的数据
        List&lt;Role&gt; currentPageData = roles.subList(startIdx, endIdx);
        LayUtils&lt;Role&gt; jsData = new LayUtils&lt;&gt;();
        jsData.setCode(0);
        jsData.setMsg(&quot;查询成功！&quot;);
        jsData.setCount((long)roles.size());
        jsData.setData(currentPageData);
        //返回前端layui需要的JSON格式
        return jsData;
    }

/---------------------------------------------------------------------------/
/**
 * 用于返回LayUI表格数据
 * {
 *   &quot;code&quot;: 0,
 *   &quot;msg&quot;: &quot;&quot;,
 *   &quot;count&quot;: 1000,
 *   &quot;data&quot;: [{}, {}]
 * }
 */
@Getter
@Setter
public class LayUtils&lt;T&gt; {

    private Integer code;
    private String msg;
    private Long count;
    private List&lt;T&gt; data;
}
</code></pre>
<ul>
<li><strong>前端难点比较多（如下）</strong></li>
</ul>
<h2 id="其他组员总结相关知识点">其他组员总结相关知识点</h2>
<h3 id="restfullayui分页异步请求">RESTful+layui+分页(异步请求)</h3>
<ul>
<li>
<h4 id="layui中先声明自己要用到的组件">layui中先声明自己要用到的组件:</h4>
</li>
</ul>
<pre><code class="language-javascript">    &lt;script type=&quot;text/javascript&quot; &gt;
&lt;%--    初始化组件,即使用哪一个初始化哪一个    --%&gt;
        layui.use(['table'], function(){
            var table = layui.table;
        });
    &lt;/script&gt;
</code></pre>
<ul>
<li>
<h4 id="然后去找自己要用的组件的相关用法比如表格"><strong>然后去找自己要用的组件的相关用法,比如表格</strong></h4>
</li>
</ul>
<pre><code class="language-javascript">    &lt;script type=&quot;text/javascript&quot; &gt;
&lt;%--    初始化组件,即使用哪一个初始化哪一个    --%&gt;
        layui.use(['table'], function(){
            var table = layui.table;
            //第一个实例
            table.render({
                elem: '#demo'
                ,height: 312
                ,url: '/student_data' //数据接口
                ,page: true //开启分页
                ,cols: [[ //表头
                    {field: 'id', title: 'ID', width:80, sort: true, fixed: 'left'}
                    ,{field: 'name', title: '姓名', width:80}
                    ,{field: 'sex', title: '性别', width:80, sort: true}
                    ,{field: 'age', title: '年龄', width:80}
                ]]
            });
        });
    &lt;/script&gt;
</code></pre>
<h3 id="restful控制层">RESTful控制层:</h3>
<pre><code class="language-java">@RequestMapping(&quot;student_data&quot;)
@RestController
public class RestfulController {
    @Autowired
    private StudentService studentService;
    @GetMapping(&quot;&quot;)
    public LayUiData&lt;Student&gt; toGetStudent(@RequestParam(value = &quot;page&quot;,required = false,defaultValue = &quot;1&quot;)int page,
                                           @RequestParam(value = &quot;limit&quot;,required = false,defaultValue = &quot;5&quot;)int limit){
        System.out.println(page + &quot; 和 &quot; +limit);
        LayUiData&lt;Student&gt; layUiData = studentService.queryStudents(page,limit);
        return layUiData;
    }
}

</code></pre>
<h3 id="逻辑层service">逻辑层Service</h3>
<pre><code class="language-java">    @Override
    public LayUiData&lt;Student&gt; queryStudents(int page,int limit) {
        cache = studentMapper.query();
        int startIndex = (page - 1)*limit;
        int endIndex = page*limit;
        if(endIndex &gt; cache.size()) {
            endIndex = cache.size();
        }
        List&lt;Student&gt; studentList = cache.subList(startIndex, endIndex);
        LayUiData&lt;Student&gt; layUiData = new LayUiData&lt;&gt;();
        layUiData.setCode(0);
        layUiData.setMsg(&quot;&quot;);
        layUiData.setCount(studentList.size());
        layUiData.setData(studentList);
        return layUiData;
    }
</code></pre>
<h3 id="树形动态菜单递归">树形动态菜单(递归)</h3>
<ul>
<li><strong>简单的前端代码</strong></li>
</ul>
<pre><code class="language-jsp">&lt;%--
  Created by IntelliJ IDEA.
  User: BW
  Date: 2019/10/31
  Time: 19:30
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;tree&lt;/title&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;/static/jquery.min.js&quot;  &gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;/static/layui/layui.js&quot; &gt;&lt;/script&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/static/layui/css/layui.css&quot;&gt;
&lt;/head&gt;
&lt;body&gt;
        &lt;div id=&quot;treefile&quot;&gt;
        &lt;/div&gt;
&lt;/body&gt;
&lt;script&gt;
                $.ajax(&quot;tree_data&quot;, {
                    type: &quot;GET&quot;,
                    data: {
                        action: &quot;json&quot;
                    },
                    dataType: &quot;json&quot;,
                    success: function(data, status_text){

                        console.log(data)
                        layui.use('tree',function () {
                                var tree = layui.tree;
                                //    渲染
                                var insert = tree.render({
                                    elem:'#treefile'
                                    ,data:[data]
                                });
                        });
                    },
                    error: function(xhr, textStatus, errorThrow) {
                        console.log(&quot;请求失败&quot;);
                    }
                });
&lt;/script&gt;
&lt;/html&gt;
</code></pre>
<ul>
<li><strong>后端测试代码及其数据格式</strong></li>
</ul>
<pre><code>import com.alibaba.fastjson.JSON;
import com.lanou.bean.LayUiStype;
import org.junit.Test;

import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.ConcurrentHashMap;

public class MyTest {
   @Test
   public void testLayuiStyle(){
       ConcurrentHashMap&lt;String,List&lt;LayUiStype&gt;&gt; map = new ConcurrentHashMap&lt;&gt;();
//  一级标题
       LayUiStype layUiStype = new LayUiStype();
       layUiStype.setTitle(&quot;山东&quot;);
//  二级标题集合
       List&lt;LayUiStype&gt; layUiStypeList = new ArrayList&lt;&gt;();
       LayUiStype layUiStype1 = new LayUiStype();
       layUiStype1.setTitle(&quot;济源&quot;);
       layUiStypeList.add(layUiStype1);
//  把二级标题放到对应的父节点下面
       layUiStype.setChildren(layUiStypeList);
       String s = JSON.toJSONString(layUiStype);
       System.out.println(s);
   }
}
```java

![在这里插入图片描述](https://img-blog.csdnimg.cn/20191102175153251.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NoZW5fbmVhbF9KYXZh,size_16,color_FFFFFF,t_70)</code></pre>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93">权限管理项目总结：</a>
<ul>
<li><a href="#git%E7%9A%84%E4%BD%BF%E7%94%A8">Git的使用</a>
<ul>
<li><a href="#1%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E4%BB%93%E5%BA%93">1.创建一个仓库</a></li>
<li><a href="#2%E6%8A%8A%E8%A6%81%E7%AE%A1%E7%90%86%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%BA%A4%E7%BB%99git%E7%AE%A1%E7%90%86-%E5%B9%B6%E5%9C%A8idea%E4%B8%AD%E7%9A%84%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE">2.把要管理的项目交给git管理、并在IDEA中的简单配置</a></li>
<li><a href="#21%E6%88%96%E8%80%85%E4%BD%BF%E7%94%A8%E5%B0%8F%E4%B9%8C%E9%BE%9Fpull-and-push">2.1（或者使用小乌龟pull and push）</a>
<ul>
<li><a href="#git%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%9A%84%E4%BD%BF%E7%94%A8">Git命令行的使用</a></li>
</ul>
</li>
<li><a href="#3%E5%88%9B%E5%BB%BAgitignore%E6%96%87%E4%BB%B6%E8%BF%9B%E8%A1%8C%E5%BF%BD%E7%95%A5%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E7%9A%84%E8%8C%83%E5%9B%B4">3.创建.gitignore文件进行忽略上传文件的范围</a></li>
</ul>
</li>
<li><a href="#%E9%A1%B9%E7%9B%AE%E5%87%BA%E9%94%99%E5%8F%8A%E5%9F%BA%E7%A1%80%E7%82%B9">项目出错及基础点：</a><br>
*
<ul>
<li><a href="#%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4">批量删除</a></li>
<li><a href="#%E6%B7%BB%E5%8A%A0%E8%A7%92%E8%89%B2%E7%9A%84%E8%A1%A8%E6%A0%BC%E4%B8%B2%E8%81%94%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE">添加角色的表格串联插入数据</a></li>
<li><a href="#%E7%BC%96%E8%BE%91%E7%9A%84%E6%97%B6%E5%80%99%E7%82%B9%E5%87%BB%E8%A1%8C%E9%BB%98%E8%AE%A4%E5%B1%95%E7%A4%BA%E8%A1%8C%E7%9A%84%E8%A1%A8%E6%A0%BC%E6%95%B0%E6%8D%AE%E9%BB%98%E8%AE%A4%E5%8B%BE%E9%80%89">编辑的时候点击行默认展示行的表格数据（默认勾选）</a>
<ul>
<li><a href="#%E5%90%8E%E7%AB%AF%E6%9F%A5%E6%95%B0%E6%8D%AE%E7%AE%80%E5%8D%95%E4%B8%BB%E8%A6%81%E8%BF%98%E6%98%AF%E5%89%8D%E7%AB%AF%E4%B8%9C%E8%A5%BF">后端查数据简单，主要还是前端东西</a></li>
</ul>
</li>
<li><a href="#%E8%A1%A8%E6%A0%BC%E5%88%86%E9%A1%B5">表格分页</a></li>
</ul>
</li>
<li><a href="#%E5%85%B6%E4%BB%96%E7%BB%84%E5%91%98%E6%80%BB%E7%BB%93%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9">其他组员总结相关知识点</a>
<ul>
<li><a href="#restfullayui%E5%88%86%E9%A1%B5%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82">RESTful+layui+分页(异步请求)</a>
<ul>
<li><a href="#layui%E4%B8%AD%E5%85%88%E5%A3%B0%E6%98%8E%E8%87%AA%E5%B7%B1%E8%A6%81%E7%94%A8%E5%88%B0%E7%9A%84%E7%BB%84%E4%BB%B6">layui中先声明自己要用到的组件:</a></li>
<li><a href="#%E7%84%B6%E5%90%8E%E5%8E%BB%E6%89%BE%E8%87%AA%E5%B7%B1%E8%A6%81%E7%94%A8%E7%9A%84%E7%BB%84%E4%BB%B6%E7%9A%84%E7%9B%B8%E5%85%B3%E7%94%A8%E6%B3%95%E6%AF%94%E5%A6%82%E8%A1%A8%E6%A0%BC"><strong>然后去找自己要用的组件的相关用法,比如表格</strong></a></li>
</ul>
</li>
<li><a href="#restful%E6%8E%A7%E5%88%B6%E5%B1%82">RESTful控制层:</a></li>
<li><a href="#%E9%80%BB%E8%BE%91%E5%B1%82service">逻辑层Service</a></li>
<li><a href="#%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%8F%9C%E5%8D%95%E9%80%92%E5%BD%92">树形动态菜单(递归)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://cxp-twx.github.io/post/springmvc-xiang-xi-zong-jie">
              <h3 class="post-title">
                SpringMVC详细总结
              </h3>
            </a>
          </div>
        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '3818ab196008bdc444d2',
    clientSecret: '25a6a1be783a52e1a00f165dd3c08fa28fba507a',
    repo: 'cxp-twx.github.io',
    owner: 'cxp-twx',
    admin: ['cxp-twx'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | 
  <a class="rss" href="https://cxp-twx.github.io/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()

  let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

  // This should probably be throttled.
  // Especially because it triggers during smooth scrolling.
  // https://lodash.com/docs/4.17.10#throttle
  // You could do like...
  // window.addEventListener("scroll", () => {
  //    _.throttle(doThatStuff, 100);
  // });
  // Only not doing it here to keep this Pen dependency-free.

  window.addEventListener("scroll", event => {
    let fromTop = window.scrollY;

    mainNavLinks.forEach((link, index) => {
      let section = document.getElementById(decodeURI(link.hash).substring(1));
      let nextSection = null
      if (mainNavLinks[index + 1]) {
        nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
      }
      if (section.offsetTop <= fromTop) {
        if (nextSection) {
          if (nextSection.offsetTop > fromTop) {
            link.classList.add("current");
          } else {
            link.classList.remove("current");    
          }
        } else {
          link.classList.add("current");
        }
      } else {
        link.classList.remove("current");
      }
    });
  });

</script>

      </div>
    </div>
  </body>
</html>
